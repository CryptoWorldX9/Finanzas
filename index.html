<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finanzas PRO | Master Edition</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    
    <style>
        :root { --p: #0f172a; --acc: #2563eb; --bg: #f8fafc; --danger: #ef4444; --success: #10b981; --grad: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); display: flex; min-height: 100vh; color: #1e293b; overflow-x: hidden; }

        /* SIDEBAR */
        .sidebar { width: 260px; background: var(--p); color: white; padding: 25px; position: fixed; height: 100vh; z-index: 1100; transition: 0.4s; }
        .main-content { margin-left: 260px; padding: 20px; width: calc(100% - 260px); margin-top: 75px; transition: 0.4s; }

        /* TOP BAR */
        .top-bar { 
            position: fixed; top: 0; left: 260px; right: 0; height: 75px; 
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); display: flex; align-items: center; padding: 0 30px;
            box-shadow: 0 1px 0px rgba(0,0,0,0.05); z-index: 1000; gap: 20px; transition: 0.4s;
        }

        .menu-btn { display: none; background: var(--p); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; }

        .balance-card { display: flex; gap: 15px; flex-grow: 1; justify-content: flex-end; }
        .bal-item { text-align: right; }
        .bal-item small { font-size: 10px; font-weight: 800; color: #64748b; text-transform: uppercase; }
        .bal-item p { font-size: 16px; font-weight: 900; }

        /* DISE√ëO SABIDUR√çA FINANCIERA (ASISTENTE) */
        .wisdom-box {
            background: white; border-radius: 20px; padding: 20px; margin-bottom: 25px;
            display: flex; align-items: center; gap: 20px; border: 1px solid #e2e8f0;
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.05); position: relative;
            overflow: hidden;
        }
        .wisdom-box::before { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 5px; background: var(--acc); }
        .wisdom-avatar { 
            width: 55px; height: 55px; background: var(--grad); border-radius: 16px; 
            display: flex; align-items: center; justify-content: center; font-size: 26px; 
            flex-shrink: 0; color: white; box-shadow: 0 8px 15px rgba(37,99,235,0.2);
        }
        .wisdom-content { flex-grow: 1; }
        .wisdom-label { font-size: 10px; font-weight: 800; color: var(--acc); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; display: block; }
        #wisdom-text { font-size: 15px; font-weight: 500; color: #334155; line-height: 1.5; transition: all 0.5s ease; opacity: 1; }

        /* CARDS & FORMS */
        .card { background: white; border-radius: 16px; padding: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.02); margin-bottom: 25px; border: 1px solid #e2e8f0; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 15px; }
        
        label { font-size: 11px; font-weight: 800; color: #64748b; text-transform: uppercase; margin-bottom: 5px; display: block; }
        input, select { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 10px; font-size: 14px; outline: none; transition: 0.2s; }
        input:focus { border-color: var(--acc); box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
        
        .btn-p { background: var(--acc); color: white; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: 700; width: 100%; transition: 0.2s; }
        .btn-p:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(37,99,235,0.2); }
        
        .nav-link { display: flex; align-items: center; gap: 12px; padding: 14px; color: #cbd5e1; cursor: pointer; border-radius: 12px; margin-bottom: 8px; transition: 0.3s; }
        .nav-link:hover { color: white; background: rgba(255,255,255,0.05); }
        .nav-link.active { background: var(--acc); color: white; box-shadow: 0 10px 15px -3px rgba(37,99,235,0.4); }

        .table-wrap { overflow-x: auto; margin-top: 15px; border-radius: 12px; border: 1px solid #e2e8f0; }
        table { width: 100%; border-collapse: collapse; min-width: 850px; }
        th { text-align: left; padding: 15px; background: #f8fafc; color: #64748b; font-size: 11px; border-bottom: 2px solid #edf2f7; text-transform: uppercase; }
        td { padding: 15px; border-bottom: 1px solid #f1f5f9; font-size: 13px; }

        .btn-action { background: white; border: 1px solid #e2e8f0; padding: 8px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .btn-action:hover { background: #f1f5f9; }

        /* RESPONSIVE M√ìVIL */
        @media (max-width: 900px) {
            .sidebar { left: -100%; width: 280px; }
            .sidebar.open { left: 0; }
            .top-bar { left: 0; padding: 15px; height: auto; flex-wrap: wrap; }
            .main-content { margin-left: 0; margin-top: 110px; width: 100%; padding: 15px; }
            .menu-btn { display: block; }
            .balance-card { width: 100%; justify-content: space-between; order: 2; margin-top: 10px; }
            .wisdom-box { padding: 15px; gap: 15px; }
            .wisdom-avatar { width: 45px; height: 45px; font-size: 20px; }
            #wisdom-text { font-size: 13px; }
        }
    </style>
</head>
<body>

<div class="top-bar">
    <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
    <div class="balance-card">
        <div class="bal-item"><small>Ingresos</small><p style="color:var(--success)" id="total-ingresos">$0</p></div>
        <div class="bal-item"><small>Egresos</small><p style="color:var(--danger)" id="total-egresos">$0</p></div>
        <div class="bal-item"><small>Saldo</small><p id="total-saldo" style="color:var(--p)">$0</p></div>
    </div>
</div>

<nav class="sidebar" id="sidebar">
    <h1 style="margin-bottom: 30px; font-weight: 900; font-size: 22px; letter-spacing: -1px;">Finanzas<span style="color:var(--acc)">PRO</span></h1>
    <div class="nav-link active" onclick="showTab('registro')">üìù <span>Registro</span></div>
    <div class="nav-link" onclick="showTab('historial')">üìú <span>Historial</span></div>
    <div class="nav-link" onclick="showTab('analisis')">üìä <span>An√°lisis</span></div>
    <div class="nav-link" onclick="showTab('ajustes')">‚öôÔ∏è <span>Ajustes</span></div>
</nav>

<main class="main-content">
    <div class="wisdom-box">
        <div class="wisdom-avatar">üíé</div>
        <div class="wisdom-content">
            <span class="wisdom-label">Sabidur√≠a Financiera</span>
            <div id="wisdom-text">Preparando tu siguiente consejo maestro...</div>
        </div>
    </div>

    <div id="registro" class="tab-content">
        <div class="card">
            <h3 id="form-title" style="font-size: 18px; font-weight: 800;">Nueva Operaci√≥n</h3><br>
            <input type="hidden" id="edit-id">
            <div class="form-grid">
                <div><label>Fecha</label><input type="date" id="f_fecha"></div>
                <div><label>Tipo</label><select id="f_tipo"><option value="Egreso">üîª Egreso</option><option value="Ingreso">üîπ Ingreso</option></select></div>
                <div><label>Monto ($)</label><input type="number" id="f_monto" oninput="calcLogic()"></div>
                <div><label>Presupuesto ($)</label><input type="number" id="f_presupuesto" oninput="calcLogic()"></div>
            </div>
            <div class="form-grid">
                <div><label>Concepto</label><input type="text" id="f_concepto" placeholder="Ej: Pago de servicios"></div>
                <div><label>Categor√≠a</label><select id="f_cat" onchange="loadSubs()"></select></div>
                <div><label>Subcategor√≠a</label><select id="f_subcat"></select></div>
                <div><label>Proveedor</label><select id="f_proveedor"></select></div>
            </div>
            <div class="form-grid">
                <div><label>Pago</label><select id="f_pago"></select></div>
                <div><label>Estado</label><select id="f_estado"><option>Pagado</option><option>Pendiente</option></select></div>
                <div><label>Recurrente</label><select id="f_recurrente"><option>No</option><option>S√≠</option></select></div>
                <div><label>Diferencia</label><p id="f_diff" style="font-weight:900; font-size:20px;">$0</p></div>
            </div>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button class="btn-p" style="flex:2" onclick="saveData()">üíæ GUARDAR REGISTRO</button>
                <button class="btn-p" style="background:#64748b; flex:1" onclick="clearForm()">üßπ LIMPIAR</button>
            </div>
        </div>

        <div class="card">
            <h3 style="font-size: 16px; font-weight: 800;">Movimientos Recientes</h3><br>
            <div class="filter-header" style="display: flex; gap: 10px; background: #f1f5f9; padding: 15px; border-radius: 12px; flex-wrap: wrap;">
                <div style="flex:2; min-width: 200px;"><label>Buscar</label><input type="text" id="reg_q" placeholder="Concepto, categor√≠a..." oninput="refreshUI()"></div>
                <div style="flex:1;"><label>Mes</label>
                    <select id="reg_m" onchange="refreshUI()">
                        <option value="">Todos</option>
                        <option value="-01">Enero</option><option value="-02">Febrero</option><option value="-03">Marzo</option><option value="-04">Abril</option><option value="-05">Mayo</option><option value="-06">Junio</option><option value="-07">Julio</option><option value="-08">Agosto</option><option value="-09">Septiembre</option><option value="-10">Octubre</option><option value="-11">Noviembre</option><option value="-12">Diciembre</option>
                    </select>
                </div>
            </div>
            <div class="table-wrap">
                <table>
                    <thead><tr><th>Fecha</th><th>Concepto</th><th>Monto</th><th>Categor√≠a</th><th>Estado</th><th>Acciones</th></tr></thead>
                    <tbody id="list_reg_table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="historial" class="tab-content" style="display:none;">
        <div class="card">
            <h3>Historial Completo</h3><br>
            <div class="table-wrap">
                <table>
                    <thead><tr><th>Fecha</th><th>Concepto</th><th>Monto</th><th>Categor√≠a</th><th>Proveedor</th><th>Estado</th><th>Acciones</th></tr></thead>
                    <tbody id="list_his_table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="analisis" class="tab-content" style="display:none;">
        <div class="form-grid">
            <div class="card"><h3>Gastos por Categor√≠a</h3><div style="height:300px"><canvas id="chartDona"></canvas></div></div>
            <div class="card">
                <h3>Ranking de Gastos</h3><br>
                <table style="width:100%"><tbody id="ana-table-body"></tbody></table>
            </div>
        </div>
    </div>
</main>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyCO6WXu9iZsyEUmNNxrE4oWToLYY8wl-y4",
      authDomain: "misfinanzaspro-d2f3f.firebaseapp.com",
      databaseURL: "https://misfinanzaspro-d2f3f-default-rtdb.firebaseio.com",
      projectId: "misfinanzaspro-d2f3f",
      storageBucket: "misfinanzaspro-d2f3f.firebasestorage.app",
      messagingSenderId: "613366165036",
      appId: "1:613366165036:web:bebc72b38d39ab64932b89"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let rawData = {};
    let donaChart = null;
    let settings = JSON.parse(localStorage.getItem('fpro_v6_settings')) || {
        cats: ['Servicios b√°sicos', 'Alimentaci√≥n', 'Transporte', 'Salud', 'Ocio', 'Inversi√≥n'],
        subs: {'Servicios b√°sicos': ['Agua', 'Luz', 'Gas', 'Internet']},
        provs: ['General', 'Supermercado', 'Banco', 'Varios'],
        pagos: ['Efectivo', 'D√©bito', 'Cr√©dito', 'Transferencia']
    };

    const frasesSabiduria = [
        "El camino a la riqueza depende de dos palabras: trabajo y ahorro.", "No ahorres lo que queda despu√©s de gastar, gasta lo que queda despu√©s de ahorrar.",
        "Cuida de los peque√±os gastos; un peque√±o agujero hunde un gran barco.", "La libertad financiera es la capacidad de vivir del flujo de caja de tus activos.",
        "El precio es lo que pagas, el valor es lo que obtienes.", "Invierte en ti mismo, es el activo que m√°s intereses te pagar√°.",
        "Nunca dependas de una sola fuente de ingresos.", "Si compras cosas que no necesitas, pronto tendr√°s que vender cosas que necesitas.",
        "La riqueza no consiste en tener grandes posesiones, sino en tener pocas necesidades.", "El inter√©s compuesto es la octava maravilla del mundo. Quien lo entiende, lo gana; quien no, lo paga.",
        "Ahorrar es el proceso de retener capital; invertir es el proceso de ponerlo a trabajar.", "Tu nivel de √©xito financiero rara vez superar√° tu nivel de desarrollo personal.",
        "No busques el momento perfecto para invertir, haz que el momento sea perfecto empezando hoy.", "El dinero es un excelente esclavo, pero un p√©simo amo.",
        "La mejor inversi√≥n que puedes hacer es en tu propia educaci√≥n.", "El riesgo viene de no saber lo que est√°s haciendo.",
        "La disciplina financiera es el puente entre tus metas y tus logros.", "Un presupuesto le dice a tu dinero a d√≥nde ir, en lugar de preguntarte a d√≥nde se fue.",
        "Ser rico es tener dinero; ser pr√≥spero es tener tiempo.", "La deuda de consumo es el impuesto que pagas por la impaciencia.",
        "El ahorro sin prop√≥sito es estancamiento; el ahorro con meta es poder.", "La educaci√≥n financiera es m√°s importante que el dinero mismo.",
        "No trabajes por el dinero, haz que el dinero trabaje para ti.", "La simplicidad es la clave de la gesti√≥n financiera exitosa.",
        "El √©xito financiero no es un sprint, es un marat√≥n de consistencia.", "Tu cuenta bancaria es un reflejo de tus h√°bitos, no de tu suerte.",
        "El costo de algo es la cantidad de vida que intercambias por ello.", "Quien controla su mente, controla su bolsillo.",
        "La verdadera riqueza es discreta; la pobreza suele ser ruidosa.", "Planifica hoy para que tu 'yo' del futuro te lo agradezca.",
        "Diversificar es la √∫nica protecci√≥n contra la ignorancia.", "El mercado financiero es un mecanismo para transferir dinero de los impacientes a los pacientes.",
        "Gasta siempre un centavo menos de lo que ganas.", "Las deudas son como el fuego: √∫tiles si se controlan, destructivas si te superan.",
        "La mejor forma de predecir tu futuro financiero es cre√°ndolo.", "La frugalidad es disfrutar de la abundancia sin caer en el desperdicio.",
        "Tu patrimonio neto es tu red de seguridad ante la incertidumbre.", "El dinero no te hace feliz, pero la falta de dinero te quita opciones.",
        "No te compares con los dem√°s, comp√°rate con tu balance del mes pasado.", "La gratificaci√≥n instant√°nea es el enemigo n√∫mero uno de tu riqueza.",
        "Aprende a decir 'no' hoy para poder decir 's√≠' a tus sue√±os ma√±ana.", "La inversi√≥n m√°s segura es liquidar tus deudas con intereses altos.",
        "Tener un fondo de emergencia no es opcional, es vital.", "La inflaci√≥n es el impuesto invisible; invierte para vencerla.",
        "La mentalidad de escasez gasta; la mentalidad de abundancia invierte.", "Cada peso que ahorras es una semilla para tu √°rbol de libertad.",
        "Simplifica tu vida y ver√°s c√≥mo se multiplica tu ahorro.", "El conocimiento paga el mejor inter√©s.",
        "No pongas todos los huevos en la misma cesta.", "El √©xito es 10% lo que ganas y 90% c√≥mo lo administras.",
        "La libertad financiera empieza con una decisi√≥n, no con un aumento de sueldo.", "El hombre m√°s rico es aquel cuyos placeres son los m√°s baratos.",
        "Los ricos invierten su dinero y gastan lo que queda; los pobres gastan su dinero e invierten lo que queda.", "La paciencia es una virtud, especialmente en las inversiones.",
        "Tu capacidad de ahorro determina tu velocidad de jubilaci√≥n.", "Automatizar tus finanzas es eliminar la tentaci√≥n de fallar.",
        "El dinero solo amplifica quien ya eres.", "No permitas que tus deseos crezcan m√°s r√°pido que tus activos.",
        "La estabilidad financiera es la paz mental convertida en n√∫meros.", "Invierte en activos, no en pasivos que parecen activos.",
        "El lujo debe ser una recompensa, no una fachada.", "La riqueza se mide en el tiempo que puedes vivir sin trabajar.",
        "El primer paso para salir del hoyo es dejar de cavar.", "Tu futuro financiero se construye en los detalles de hoy.",
        "No confundas un buen estilo de vida con una buena vida.", "El valor de una persona no se mide por su saldo, pero su libertad s√≠.",
        "La curiosidad financiera te salvar√° de errores costosos.", "Protege tu capital como si fuera tu vida, porque es tu tiempo.",
        "Aprende las reglas del juego antes de poner tu dinero en la mesa.", "La sabidur√≠a financiera es saber distinguir un activo de un capricho.",
        "La meta no es ser rico, la meta es ser libre."
    ];

    function init() {
        document.getElementById('f_fecha').valueAsDate = new Date();
        startWisdomSystem();
        loadDropdowns();
        db.ref('movimientos').on('value', snap => {
            rawData = snap.val() || {};
            refreshUI();
            updateCharts();
        });
    }

    function startWisdomSystem() {
        const textEl = document.getElementById('wisdom-text');
        let index = Math.floor(Math.random() * frasesSabiduria.length);
        const update = () => {
            textEl.style.opacity = 0;
            textEl.style.transform = "translateY(5px)";
            setTimeout(() => {
                textEl.innerText = frasesSabiduria[index];
                textEl.style.opacity = 1;
                textEl.style.transform = "translateY(0)";
                index = (index + 1) % frasesSabiduria.length;
            }, 500);
        };
        update();
        setInterval(update, 10000);
    }

    function refreshUI() {
        let ing = 0, eg = 0;
        const rq = document.getElementById('reg_q').value.toLowerCase();
        const rm = document.getElementById('reg_m').value;
        const tableReg = document.getElementById('list_reg_table');
        const tableHis = document.getElementById('list_his_table');
        tableReg.innerHTML = ''; tableHis.innerHTML = '';

        Object.keys(rawData).reverse().forEach(key => {
            const d = rawData[key];
            if(d.tipo === 'Ingreso') ing += d.monto; else eg += d.monto;
            const match = `${d.concepto} ${d.cat}`.toLowerCase().includes(rq) && (rm ? d.fecha.includes(rm) : true);
            
            const row = `<tr>
                <td>${d.fecha}</td>
                <td><b>${d.concepto}</b></td>
                <td style="color:${d.tipo==='Ingreso'?'#10b981':'#ef4444'}"><b>$${d.monto.toLocaleString()}</b></td>
                <td><small>${d.cat}</small></td>
                <td><span style="padding:4px 8px; border-radius:6px; font-size:10px; background:${d.estado==='Pagado'?'#dcfce7':'#fee2e2'}; color:${d.estado==='Pagado'?'#166534':'#991b1b'}">${d.estado}</span></td>
                <td>
                    <button class="btn-action" onclick="editItem('${key}')">‚úèÔ∏è</button>
                    <button class="btn-action" onclick="deleteItem('${key}')" style="color:red">üóëÔ∏è</button>
                </td>
            </tr>`;
            if(match) tableReg.innerHTML += row;
            tableHis.innerHTML += row;
        });

        document.getElementById('total-ingresos').innerText = `$${ing.toLocaleString()}`;
        document.getElementById('total-egresos').innerText = `$${eg.toLocaleString()}`;
        document.getElementById('total-saldo').innerText = `$${(ing - eg).toLocaleString()}`;
    }

    function updateCharts() {
        const ctx = document.getElementById('chartDona');
        let catTotals = {};
        Object.values(rawData).forEach(d => { if(d.tipo==='Egreso') catTotals[d.cat] = (catTotals[d.cat]||0) + d.monto; });
        if(donaChart) donaChart.destroy();
        donaChart = new Chart(ctx, {
            type: 'doughnut',
            data: { labels: Object.keys(catTotals), datasets: [{ data: Object.values(catTotals), backgroundColor: ['#2563eb','#10b981','#f59e0b','#ef4444','#8b5cf6','#06b6d4'] }] },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
        });
        const sorted = Object.entries(catTotals).sort((a,b) => b[1]-a[1]);
        document.getElementById('ana-table-body').innerHTML = sorted.slice(0,5).map(i => `<tr><td>${i[0]}</td><td align="right"><b>$${i[1].toLocaleString()}</b></td></tr>`).join('');
    }

    function saveData() {
        const id = document.getElementById('edit-id').value;
        const data = {
            fecha: document.getElementById('f_fecha').value,
            tipo: document.getElementById('f_tipo').value,
            monto: parseFloat(document.getElementById('f_monto').value) || 0,
            presupuesto: parseFloat(document.getElementById('f_presupuesto').value) || 0,
            concepto: document.getElementById('f_concepto').value,
            cat: document.getElementById('f_cat').value,
            subcat: document.getElementById('f_subcat').value,
            pago: document.getElementById('f_pago').value,
            estado: document.getElementById('f_estado').value,
            proveedor: document.getElementById('f_proveedor').value,
            recurrente: document.getElementById('f_recurrente').value
        };
        if(id) db.ref('movimientos/' + id).set(data); else db.ref('movimientos').push(data);
        clearForm();
    }

    function editItem(key) {
        const d = rawData[key];
        document.getElementById('edit-id').value = key;
        document.getElementById('f_fecha').value = d.fecha;
        document.getElementById('f_monto').value = d.monto;
        document.getElementById('f_concepto').value = d.concepto;
        document.getElementById('f_cat').value = d.cat;
        document.getElementById('f_tipo').value = d.tipo;
        document.getElementById('form-title').innerText = "‚úèÔ∏è Editando...";
        showTab('registro');
        window.scrollTo({top: 0, behavior: 'smooth'});
    }

    function deleteItem(key) { if(confirm("¬øEliminar?")) db.ref('movimientos/' + key).remove(); }
    function clearForm() { document.getElementById('edit-id').value = ''; document.getElementById('f_monto').value = ''; document.getElementById('f_concepto').value = ''; document.getElementById('form-title').innerText = "Nueva Operaci√≥n"; }
    function calcLogic() {
        const m = parseFloat(document.getElementById('f_monto').value) || 0;
        const p = parseFloat(document.getElementById('f_presupuesto').value) || 0;
        document.getElementById('f_diff').innerText = `$${(p - m).toLocaleString()}`;
        document.getElementById('f_diff').style.color = (p - m) < 0 ? 'red' : 'green';
    }
    function loadDropdowns() {
        const fill = (id, arr) => document.getElementById(id).innerHTML = arr.map(i => `<option>${i}</option>`).join('');
        fill('f_cat', settings.cats); fill('f_proveedor', settings.provs); fill('f_pago', settings.pagos);
        loadSubs();
    }
    function loadSubs() {
        const c = document.getElementById('f_cat').value;
        const s = settings.subs[c] || ['General'];
        document.getElementById('f_subcat').innerHTML = s.map(v => `<option>${v}</option>`).join('');
    }
    function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }
    function showTab(id) {
        document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
        document.getElementById(id).style.display = 'block';
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        const activeLink = document.querySelector(`[onclick="showTab('${id}')"]`);
        if(activeLink) activeLink.classList.add('active');
        if(window.innerWidth < 900) document.getElementById('sidebar').classList.remove('open');
    }

    window.onload = init;
</script>
</body>
</html>
